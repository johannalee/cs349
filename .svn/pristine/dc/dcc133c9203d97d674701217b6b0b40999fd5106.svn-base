#include "Slider.h"
#include "XWindow.h"
#include "Logging.h"
#include <algorithm>

using namespace cs349;
using namespace std;

Slider::Slider(const string & name, OrientationType orientation)
  : Component(name)
{
  lowerBound = 0;
  upperBound = 0;
  curValue = 0;
  lowerBoundLabel = "";
  upperBoundLabel = "";
  thumbLabel = "";
  this->orientation = orientation;

// TODO CS349
  sliderLength = 280;
}

void Slider::AddValueListener(ValueListener* l) {
// TODO CS349
  listeners.push_back(l);
}

void Slider::RemoveValueListener(ValueListener* l) {
// TODO CS349
  remove(listeners.begin(), listeners.end(), l);
}

int Slider::GetMinimum() const {
  return lowerBound;
}

int Slider::GetMaximum() const {
  return upperBound;
}

int Slider::GetCurValue() const {
  return curValue;
}

void Slider::SetMinimum(int minValue) {
// TODO CS349
  this->lowerBound = minValue;
}

void Slider::SetMaximum(int maxValue) {
// TODO CS349
  this->upperBound = maxValue;
}

void Slider::SetCurValue(int value) {
// TODO CS349
  int diff = value - this->lowerBound;

  if(diff < 0){
    this->curValue = -1;
  }else{
    this->curValue = (value/diff) * sliderLength;
  }
}

Slider::OrientationType Slider::GetOrientation() const {
  return orientation;
}

void Slider::SetOrientation(OrientationType orientation) {
  this->orientation = orientation;
  this->Repaint();
}

void Slider::PaintComponent(Graphics* g) {
// TODO CS349
  int lineX = 30;
  int lineY = 10;
  int textY = lineY+40;
  int thumbWidth = 7;
  int thumbHeight = 20;
  int posX = curValue + lineX;

  g->SetForegroundColor(0x000000);
  g->FillRect(Rectangle(0, 0, 400, 150));

  g->SetForegroundColor(0xFFFFFF);

  //Slider Line
  g->DrawLine(Point(lineX, lineY), Point(lineX+sliderLength, lineY));

  //Bounds and Thumb Labels
  g->DrawText(Point((lineX-7), textY), this->GetLowerBoundLabel());
  g->DrawText(Point((lineX+(sliderLength/2)), textY), this->GetUpperBoundLabel());
  g->DrawText(Point((lineX+sliderLength-7), textY), this->GetThumbLabel());

  //thumb
  g->FillRect(Rectangle(posX, (lineY-(thumbHeight/2)), thumbWidth, thumbHeight));

}

string Slider::GetLowerBoundLabel() const {
  return lowerBoundLabel;
}

string Slider::GetUpperBoundLabel() const {
  return upperBoundLabel;
}

string Slider::GetThumbLabel() const {
  return thumbLabel;
}

void Slider::SetLowerBoundLabel(const string & label) {
  this->lowerBoundLabel = label;
  this->Repaint();
}

void Slider::SetUpperBoundLabel(const string & label) {
  this->upperBoundLabel = label;
  this->Repaint();
}

void Slider::SetThumbLabel(const string & label) {
  this->thumbLabel = label;
  this->Repaint();
}

// TODO CS349: Implement any other methods needed here
// TODO CS349

bool Slider::HandleMouseEvent(const MouseEvent & e){

}


